<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><script>var yiliaConfig={fancybox:!0,animate:!1,isHome:!1,isPost:!1,isArchive:!0,isTag:!1,isCategory:!1,open_in_new:!0,rootUrl:"/"}</script><title>JDK8 Stream</title><link rel=icon href=/favicon.png><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/font-awesome/css/font-awesome.min.css><link rel=apple-touch-icon href=/apple-touch-icon.png><link rel=stylesheet href=/fancybox/jquery.fancybox.css><link rel=stylesheet href=/highlight/styles/intellij-light.min.css><script src=/highlight/highlight.pack.js></script>
<script>hljs.initHighlightingOnLoad()</script></head><body><body><div id=container><div class=left-col><div class=overlay></div><div class=intrude-less><header id=header class=inner><a href=/ class=profilepic><img src=/img/head-portrait.jpg class="animated zoomIn js-avatar"></a><hgroup><h1 class=header-author><a href=/>aliveyang</a></h1></hgroup><p class=header-subtitle>无处觅菰蒲</p><div id=switch-btn class=switch-btn><div class=icon><div class=icon-ctn><div class="icon-wrap icon-house" data-idx=0><div class=birdhouse></div><div class=birdhouse_holes></div></div><div class="icon-wrap icon-ribbon hide" data-idx=1><div class=ribbon></div></div><div class="icon-wrap icon-link hide" data-idx=2><div class=loopback_l></div><div class=loopback_r></div></div><div class="icon-wrap icon-me hide" data-idx=3><div class=user></div><div class=shoulder></div></div></div></div><div class="tips-box hide"><div class=tips-arrow></div><ul class=tips-inner><li>菜单</li><li>标签</li><li>友情链接</li><li>关于我</li></ul></div></div><div id=switch-area class=switch-area><div class=switch-wrap><section class="switch-part switch-part1"><nav class=header-menu><ul><li><a href=/./>主页</a></li><li><a href=/./post/>所有文章</a></li><li><a href=/./tags/>标签云</a></li></ul></nav><nav class=header-nav><ul class=social></ul></nav></section><section class="switch-part switch-part2"><div class="widget tagcloud" id=js-tagcloud><a href=/tags/hugo style=font-size:12px class=color2>Hugo</a>
<a href=/tags/java style=font-size:12px class=color3>Java</a>
<a href=/tags/win style=font-size:12px class=color1>Win</a></div></section><section class="switch-part switch-part3"><div id=js-friends><a target=_self class="main-nav-link switch-friends-link" href=https://v2ex.com>v2ex</a>
<a target=_self class="main-nav-link switch-friends-link" href=https://coolshell.cn/>酷壳</a></div></section><section class="switch-part switch-part4"><div id=js-aboutme>无处觅菰蒲</div></section></div></div></header></div></div><div class=mid-col><nav id=mobile-nav><div class=overlay><h1 class="header-author js-mobile-header hide"><a href=/ title=回到主页>aliveyang</a></h1></div><div class=intrude-less><header id=header class=inner><a href=/ class=profilepic><img src=/img/head-portrait.jpg class="animated zoomIn"></a><hgroup><h1 class=header-author><a href=/ title=回到主页>aliveyang</a></h1></hgroup><p class=header-subtitle>无处觅菰蒲</p><nav class=header-menu><ul><li><a href=/./>主页</a></li><li><a href=/./post/>所有文章</a></li><li><a href=/./tags/>标签云</a></li><div class=clearfix></div></ul></nav><nav class=header-nav><ul class=social></ul></nav></header></div></nav><div class=body-wrap><article id=post-js-android class="article article-type-post" itemscope itemprop=blogPost><div class=article-meta><a href=https://aliveyang.top/post/jdk8stream/ class=article-date><time datetime="2020-02-04 00:00:00 +0000 UTC" itemprop=datePublished>2020-02-04</time></a></div><div class=article-inner><input type=hidden class=isFancy><header class=article-header><h1 class=article-title itemprop=name><a class=article-title href=https://aliveyang.top/post/jdk8stream/>JDK8 Stream</a></h1></header><div class="article-info article-info-post"><div class="article-tag tagcloud"><ul class=article-tag-list><li class=article-tag-list-item><a class="article-tag-list-link color1" href=/tags/java/ style=font-size:12px>java</a></li></ul></div><div class=clearfix></div></div><div class=article-entry itemprop=articleBody><p><strong>JDK8 Stream</strong></p><h2 id=概括>概括</h2><p>一个stream周期总共包含三个操作：<code>获取流</code>、<code>数据操作</code>、<code>结果生产</code></p><h2 id=获取流>获取流</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// list
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>asList</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;1&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;2&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;3&#34;</span><span style=color:#f92672>).</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// array
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> String<span style=color:#f92672>[]{</span><span style=color:#e6db74>&#34;1&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;2&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;3&#34;</span><span style=color:#f92672>})</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 自定义
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Stream<span style=color:#f92672>.</span><span style=color:#a6e22e>generate</span><span style=color:#f92672>(</span>Math<span style=color:#f92672>::</span>random<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 递归
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Stream<span style=color:#f92672>.</span><span style=color:#a6e22e>iterate</span><span style=color:#f92672>(</span><span style=color:#ae81ff>2</span><span style=color:#f92672>,</span> i <span style=color:#f92672>-&gt;</span> i <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>);</span> <span style=color:#75715e>//生成2的N次方数据
</span></span></span></code></pre></div><h2 id=数据操作>数据操作</h2><h3 id=peek-元素调整>peek() 元素调整</h3><p>对元素内部数据进行调整</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java></code></pre></div><h3 id=map-映射转换>map() 映射转换</h3><p>将元素本身进行加工或类型转换</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java></code></pre></div><h3 id=flatmap-展平结果>flatMap() 展平结果</h3><p>将多级结构转换为平铺结构</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * flatMap()用于展平结果，将多级结构转换为平铺结构
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>whenFlatMapEmployeeNames_thenGetNameStream</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>List<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;&gt;</span> namesNested <span style=color:#f92672>=</span> Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>asList</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>            Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>asList</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Jeff&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Bezos&#34;</span><span style=color:#f92672>),</span>
</span></span><span style=display:flex><span>            Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>asList</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Bill&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Gates&#34;</span><span style=color:#f92672>),</span>
</span></span><span style=display:flex><span>            Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>asList</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Mark&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Zuckerberg&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> namesFlatStream <span style=color:#f92672>=</span> namesNested<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>flatMap</span><span style=color:#f92672>(</span>Collection<span style=color:#f92672>::</span>stream<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>collect</span><span style=color:#f92672>(</span>Collectors<span style=color:#f92672>.</span><span style=color:#a6e22e>toList</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>namesFlatStream<span style=color:#f92672>);</span> <span style=color:#75715e>// [Jeff, Bezos, Bill, Gates, Mark, Zuckerberg]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=filter-过滤>filter 过滤</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java></code></pre></div><h3 id=skip-跳过>skip() 跳过</h3><h3 id=limit-获取>limit() 获取</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 偏移量运算，skip跳过三个，limit向后获取5个
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>whenLimitInfiniteStream_thenGetFiniteElements</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//iterate迭代器方法用于生成流的规则，生成以为2的N次方数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    Stream<span style=color:#f92672>&lt;</span>Integer<span style=color:#f92672>&gt;</span> infiniteStream <span style=color:#f92672>=</span> Stream<span style=color:#f92672>.</span><span style=color:#a6e22e>iterate</span><span style=color:#f92672>(</span><span style=color:#ae81ff>2</span><span style=color:#f92672>,</span> i <span style=color:#f92672>-&gt;</span> i <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>infiniteStream<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>Integer<span style=color:#f92672>&gt;</span> collect <span style=color:#f92672>=</span> infiniteStream
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>skip</span><span style=color:#f92672>(</span><span style=color:#ae81ff>3</span><span style=color:#f92672>)</span><span style=color:#75715e>//跳过2^1,2^2,2^3
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>limit</span><span style=color:#f92672>(</span><span style=color:#ae81ff>5</span><span style=color:#f92672>)</span><span style=color:#75715e>//保留2^4、2^5、2^6、2^7、2^8
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>collect</span><span style=color:#f92672>(</span>Collectors<span style=color:#f92672>.</span><span style=color:#a6e22e>toList</span><span style=color:#f92672>());</span><span style=color:#75715e>//转换为数字
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>collect<span style=color:#f92672>);</span> <span style=color:#75715e>// [16, 32, 64, 128, 256]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=sorted-排序>sorted() 排序</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java></code></pre></div><h3 id=distinct-去重>distinct() 去重</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java></code></pre></div><h3 id=match-匹配判定>match() 匹配判定</h3><h4 id=allmatch-全部符合>allMatch() 全部符合</h4><h4 id=anymatch-存在符合>anyMatch() 存在符合</h4><h4 id=nonematch-全部不符合>noneMatch() 全部不符合</h4><p>规则匹配返回Boolean</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * allMatch()判断给定的流数据是否全部符合判断要求，全部满足返回true
</span></span></span><span style=display:flex><span><span style=color:#75715e> * anyMatch()判断给定的流数据是否存在符合要求的数据，只要有一个满足则返回true
</span></span></span><span style=display:flex><span><span style=color:#75715e> * noneMatch()与anyMatch()相反，只要有一个满足要求则返回false
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>whenApplyMatch_thenReturnBoolean</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>Integer<span style=color:#f92672>&gt;</span> intList <span style=color:#f92672>=</span> Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>asList</span><span style=color:#f92672>(</span><span style=color:#ae81ff>2</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>4</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>5</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>6</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>8</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>boolean</span> allEven <span style=color:#f92672>=</span> intList<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>().</span><span style=color:#a6e22e>allMatch</span><span style=color:#f92672>(</span>i <span style=color:#f92672>-&gt;</span> i <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>boolean</span> oneEven <span style=color:#f92672>=</span> intList<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>().</span><span style=color:#a6e22e>anyMatch</span><span style=color:#f92672>(</span>i <span style=color:#f92672>-&gt;</span> i <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>boolean</span> noneMultipleOfThree <span style=color:#f92672>=</span> intList<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>().</span><span style=color:#a6e22e>noneMatch</span><span style=color:#f92672>(</span>i <span style=color:#f92672>-&gt;</span> i <span style=color:#f92672>%</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    assertEquals<span style=color:#f92672>(</span>allEven<span style=color:#f92672>,</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    assertEquals<span style=color:#f92672>(</span>oneEven<span style=color:#f92672>,</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    assertEquals<span style=color:#f92672>(</span>noneMultipleOfThree<span style=color:#f92672>,</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=parallel-并行处理>parallel() 并行处理</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * parallel()并行处理
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>whenParallelStream_thenPerformOperationsInParallel</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    Employee<span style=color:#f92672>[]</span> arrayOfEmps <span style=color:#f92672>=</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>new</span> Employee<span style=color:#f92672>(</span><span style=color:#ae81ff>1</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Jeff Bezos&#34;</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>100000</span><span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>),</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>new</span> Employee<span style=color:#f92672>(</span><span style=color:#ae81ff>2</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Bill Gates&#34;</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>200000</span><span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>),</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>new</span> Employee<span style=color:#f92672>(</span><span style=color:#ae81ff>3</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Mark Zuckerberg&#34;</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>300000</span><span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>Employee<span style=color:#f92672>&gt;</span> empList <span style=color:#f92672>=</span> Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>asList</span><span style=color:#f92672>(</span>arrayOfEmps<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    empList<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>().</span><span style=color:#a6e22e>parallel</span><span style=color:#f92672>().</span><span style=color:#a6e22e>forEach</span><span style=color:#f92672>(</span>e <span style=color:#f92672>-&gt;</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>salaryIncrement</span><span style=color:#f92672>(</span><span style=color:#ae81ff>10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    assertThat<span style=color:#f92672>(</span>empList<span style=color:#f92672>,</span> contains<span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>            hasProperty<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;salary&#34;</span><span style=color:#f92672>,</span> equalTo<span style=color:#f92672>(</span><span style=color:#ae81ff>110000</span><span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>)),</span>
</span></span><span style=display:flex><span>            hasProperty<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;salary&#34;</span><span style=color:#f92672>,</span> equalTo<span style=color:#f92672>(</span><span style=color:#ae81ff>220000</span><span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>)),</span>
</span></span><span style=display:flex><span>            hasProperty<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;salary&#34;</span><span style=color:#f92672>,</span> equalTo<span style=color:#f92672>(</span><span style=color:#ae81ff>330000</span><span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>));</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=结束操作>结束操作</h2><h3 id=foreach>forEach()</h3><p>替代for循环</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java></code></pre></div><h3 id=findfirst-获取首个>findFirst() 获取首个</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * findFirst()获取第一个符合规则的流数据
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 如果一个都没有则走orElse()返回Null
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>whenFindFirst_thenGetFirstEmployeeInStream</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    Integer<span style=color:#f92672>[]</span> empIds <span style=color:#f92672>=</span> <span style=color:#f92672>{</span><span style=color:#ae81ff>1</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>3</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>4</span><span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>    Employee employee <span style=color:#f92672>=</span> Stream<span style=color:#f92672>.</span><span style=color:#a6e22e>of</span><span style=color:#f92672>(</span>empIds<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>map</span><span style=color:#f92672>(</span>employeeRepository<span style=color:#f92672>::</span>findById<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>filter</span><span style=color:#f92672>(</span>e <span style=color:#f92672>-&gt;</span> e <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>filter</span><span style=color:#f92672>(</span>e <span style=color:#f92672>-&gt;</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>getSalary</span><span style=color:#f92672>()</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>100000</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>findFirst</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>orElse</span><span style=color:#f92672>(</span><span style=color:#66d9ef>null</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>employee<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=collect-集合类型转换>collect() 集合类型转换</h3><h4 id=collectorstoset>Collectors.toSet()</h4><h4 id=collectorsjoining>Collectors.joining()</h4><p>流数据转为一条字符串</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * collect(Collectors.joining(&#34;, &#34;)) 将流数据转为一个长字符串
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>whenCollectByJoining_thenGetJoinedString</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    String empNames <span style=color:#f92672>=</span> empList<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>map</span><span style=color:#f92672>(</span>Employee<span style=color:#f92672>::</span>getName<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>collect</span><span style=color:#f92672>(</span>Collectors<span style=color:#f92672>.</span><span style=color:#a6e22e>joining</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;, &#34;</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    assertEquals<span style=color:#f92672>(</span>empNames<span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Jeff Bezos, Bill Gates, Mark Zuckerberg&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h4 id=collectorssummarizing-聚合运算>Collectors.summarizing&mldr; 聚合运算</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 流数据为对象时，聚合运算.
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>whenApplySummarizing_thenGetBasicStats</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    DoubleSummaryStatistics stats <span style=color:#f92672>=</span> empList<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>collect</span><span style=color:#f92672>(</span>Collectors<span style=color:#f92672>.</span><span style=color:#a6e22e>summarizingDouble</span><span style=color:#f92672>(</span>Employee<span style=color:#f92672>::</span>getSalary<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    assertEquals<span style=color:#f92672>(</span>stats<span style=color:#f92672>.</span><span style=color:#a6e22e>getCount</span><span style=color:#f92672>(),</span> <span style=color:#ae81ff>3</span><span style=color:#f92672>);</span> <span style=color:#75715e>//数量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    assertEquals<span style=color:#f92672>(</span>stats<span style=color:#f92672>.</span><span style=color:#a6e22e>getSum</span><span style=color:#f92672>(),</span> <span style=color:#ae81ff>600000</span><span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>);</span><span style=color:#75715e>//求和
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    assertEquals<span style=color:#f92672>(</span>stats<span style=color:#f92672>.</span><span style=color:#a6e22e>getMin</span><span style=color:#f92672>(),</span> <span style=color:#ae81ff>100000</span><span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>);</span><span style=color:#75715e>//最小值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    assertEquals<span style=color:#f92672>(</span>stats<span style=color:#f92672>.</span><span style=color:#a6e22e>getMax</span><span style=color:#f92672>(),</span> <span style=color:#ae81ff>300000</span><span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>);</span><span style=color:#75715e>//最大值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    assertEquals<span style=color:#f92672>(</span>stats<span style=color:#f92672>.</span><span style=color:#a6e22e>getAverage</span><span style=color:#f92672>(),</span> <span style=color:#ae81ff>200000</span><span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>);</span><span style=color:#75715e>//平均值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 流数据为数值时，直接聚合运算
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>whenApplySummaryStatistics_thenGetBasicStats</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    DoubleSummaryStatistics stats <span style=color:#f92672>=</span> empList<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>mapToDouble</span><span style=color:#f92672>(</span>Employee<span style=color:#f92672>::</span>getSalary<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>summaryStatistics</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    assertEquals<span style=color:#f92672>(</span>stats<span style=color:#f92672>.</span><span style=color:#a6e22e>getCount</span><span style=color:#f92672>(),</span> <span style=color:#ae81ff>3</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    assertEquals<span style=color:#f92672>(</span>stats<span style=color:#f92672>.</span><span style=color:#a6e22e>getSum</span><span style=color:#f92672>(),</span> <span style=color:#ae81ff>600000</span><span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    assertEquals<span style=color:#f92672>(</span>stats<span style=color:#f92672>.</span><span style=color:#a6e22e>getMin</span><span style=color:#f92672>(),</span> <span style=color:#ae81ff>100000</span><span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    assertEquals<span style=color:#f92672>(</span>stats<span style=color:#f92672>.</span><span style=color:#a6e22e>getMax</span><span style=color:#f92672>(),</span> <span style=color:#ae81ff>300000</span><span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    assertEquals<span style=color:#f92672>(</span>stats<span style=color:#f92672>.</span><span style=color:#a6e22e>getAverage</span><span style=color:#f92672>(),</span> <span style=color:#ae81ff>200000</span><span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h4 id=collectorspartitioningby-分区运算>Collectors.partitioningBy() 分区运算</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * partitioningBy()分区运算，类似于SQL中的Group By ，并将其放入各自的Map&#39;s value中
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>whenStreamPartition_thenGetMap</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>Integer<span style=color:#f92672>&gt;</span> intList <span style=color:#f92672>=</span> Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>asList</span><span style=color:#f92672>(</span><span style=color:#ae81ff>2</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>4</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>5</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>6</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>8</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    Map<span style=color:#f92672>&lt;</span>Boolean<span style=color:#f92672>,</span> List<span style=color:#f92672>&lt;</span>Integer<span style=color:#f92672>&gt;&gt;</span> isEven <span style=color:#f92672>=</span> intList<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>().</span><span style=color:#a6e22e>collect</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>            Collectors<span style=color:#f92672>.</span><span style=color:#a6e22e>partitioningBy</span><span style=color:#f92672>(</span>i <span style=color:#f92672>-&gt;</span> i <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    assertEquals<span style=color:#f92672>(</span>isEven<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>).</span><span style=color:#a6e22e>size</span><span style=color:#f92672>(),</span> <span style=color:#ae81ff>4</span><span style=color:#f92672>);</span><span style=color:#75715e>//偶数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    assertEquals<span style=color:#f92672>(</span>isEven<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#66d9ef>false</span><span style=color:#f92672>).</span><span style=color:#a6e22e>size</span><span style=color:#f92672>(),</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>);</span><span style=color:#75715e>//奇数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 按自定义条件进行分区(Group By)
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>whenStreamGroupingBy_thenGetMap</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//按首字母进行分区
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    Map<span style=color:#f92672>&lt;</span>Character<span style=color:#f92672>,</span> List<span style=color:#f92672>&lt;</span>Employee<span style=color:#f92672>&gt;&gt;</span> groupByAlphabet <span style=color:#f92672>=</span> empList<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>().</span><span style=color:#a6e22e>collect</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>            Collectors<span style=color:#f92672>.</span><span style=color:#a6e22e>groupingBy</span><span style=color:#f92672>(</span>e <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>new</span> Character<span style=color:#f92672>(</span>e<span style=color:#f92672>.</span><span style=color:#a6e22e>getName</span><span style=color:#f92672>().</span><span style=color:#a6e22e>charAt</span><span style=color:#f92672>(</span><span style=color:#ae81ff>0</span><span style=color:#f92672>))));</span>
</span></span><span style=display:flex><span>    assertEquals<span style=color:#f92672>(</span>groupByAlphabet<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#39;B&#39;</span><span style=color:#f92672>).</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#ae81ff>0</span><span style=color:#f92672>).</span><span style=color:#a6e22e>getName</span><span style=color:#f92672>(),</span> <span style=color:#e6db74>&#34;Bill Gates&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    assertEquals<span style=color:#f92672>(</span>groupByAlphabet<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#39;J&#39;</span><span style=color:#f92672>).</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#ae81ff>0</span><span style=color:#f92672>).</span><span style=color:#a6e22e>getName</span><span style=color:#f92672>(),</span> <span style=color:#e6db74>&#34;Jeff Bezos&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    assertEquals<span style=color:#f92672>(</span>groupByAlphabet<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#39;M&#39;</span><span style=color:#f92672>).</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#ae81ff>0</span><span style=color:#f92672>).</span><span style=color:#a6e22e>getName</span><span style=color:#f92672>(),</span> <span style=color:#e6db74>&#34;Mark Zuckerberg&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * groupingBy高级玩法，先按首字母分区，然后将分区内数据转换为ID&#39;List
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>whenStreamMapping_thenGetMap</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    Map<span style=color:#f92672>&lt;</span>Character<span style=color:#f92672>,</span> List<span style=color:#f92672>&lt;</span>Integer<span style=color:#f92672>&gt;&gt;</span> idGroupedByAlphabet <span style=color:#f92672>=</span> empList<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>().</span><span style=color:#a6e22e>collect</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>            Collectors<span style=color:#f92672>.</span><span style=color:#a6e22e>groupingBy</span><span style=color:#f92672>(</span>e <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>new</span> Character<span style=color:#f92672>(</span>e<span style=color:#f92672>.</span><span style=color:#a6e22e>getName</span><span style=color:#f92672>().</span><span style=color:#a6e22e>charAt</span><span style=color:#f92672>(</span><span style=color:#ae81ff>0</span><span style=color:#f92672>)),</span>
</span></span><span style=display:flex><span>                    Collectors<span style=color:#f92672>.</span><span style=color:#a6e22e>mapping</span><span style=color:#f92672>(</span>Employee<span style=color:#f92672>::</span>getId<span style=color:#f92672>,</span> Collectors<span style=color:#f92672>.</span><span style=color:#a6e22e>toList</span><span style=color:#f92672>())));</span>
</span></span><span style=display:flex><span>    assertEquals<span style=color:#f92672>(</span>idGroupedByAlphabet<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#39;B&#39;</span><span style=color:#f92672>).</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#ae81ff>0</span><span style=color:#f92672>),</span> <span style=color:#66d9ef>new</span> Integer<span style=color:#f92672>(</span><span style=color:#ae81ff>2</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    assertEquals<span style=color:#f92672>(</span>idGroupedByAlphabet<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#39;J&#39;</span><span style=color:#f92672>).</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#ae81ff>0</span><span style=color:#f92672>),</span> <span style=color:#66d9ef>new</span> Integer<span style=color:#f92672>(</span><span style=color:#ae81ff>1</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    assertEquals<span style=color:#f92672>(</span>idGroupedByAlphabet<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#39;M&#39;</span><span style=color:#f92672>).</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#ae81ff>0</span><span style=color:#f92672>),</span> <span style=color:#66d9ef>new</span> Integer<span style=color:#f92672>(</span><span style=color:#ae81ff>3</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>whenStreamReducing_thenGetValue</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    Double percentage <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span><span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    Double salIncrOverhead <span style=color:#f92672>=</span> empList<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>().</span><span style=color:#a6e22e>collect</span><span style=color:#f92672>(</span>Collectors<span style=color:#f92672>.</span><span style=color:#a6e22e>reducing</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>            <span style=color:#ae81ff>0</span><span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>,</span> e <span style=color:#f92672>-&gt;</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>getSalary</span><span style=color:#f92672>()</span> <span style=color:#f92672>*</span> percentage <span style=color:#f92672>/</span> <span style=color:#ae81ff>100</span><span style=color:#f92672>,</span> <span style=color:#f92672>(</span>s1<span style=color:#f92672>,</span> s2<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;</span> s1 <span style=color:#f92672>+</span> s2<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    assertEquals<span style=color:#f92672>(</span>salIncrOverhead<span style=color:#f92672>,</span> <span style=color:#ae81ff>60000</span><span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>whenStreamGroupingAndReducing_thenGetMap</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    Comparator<span style=color:#f92672>&lt;</span>Employee<span style=color:#f92672>&gt;</span> byNameLength <span style=color:#f92672>=</span> Comparator<span style=color:#f92672>.</span><span style=color:#a6e22e>comparing</span><span style=color:#f92672>(</span>Employee<span style=color:#f92672>::</span>getName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    Map<span style=color:#f92672>&lt;</span>Character<span style=color:#f92672>,</span> Optional<span style=color:#f92672>&lt;</span>Employee<span style=color:#f92672>&gt;&gt;</span> longestNameByAlphabet <span style=color:#f92672>=</span> empList<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>().</span><span style=color:#a6e22e>collect</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>            Collectors<span style=color:#f92672>.</span><span style=color:#a6e22e>groupingBy</span><span style=color:#f92672>(</span>e <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>new</span> Character<span style=color:#f92672>(</span>e<span style=color:#f92672>.</span><span style=color:#a6e22e>getName</span><span style=color:#f92672>().</span><span style=color:#a6e22e>charAt</span><span style=color:#f92672>(</span><span style=color:#ae81ff>0</span><span style=color:#f92672>)),</span>
</span></span><span style=display:flex><span>                    Collectors<span style=color:#f92672>.</span><span style=color:#a6e22e>reducing</span><span style=color:#f92672>(</span>BinaryOperator<span style=color:#f92672>.</span><span style=color:#a6e22e>maxBy</span><span style=color:#f92672>(</span>byNameLength<span style=color:#f92672>))));</span>
</span></span><span style=display:flex><span>    assertEquals<span style=color:#f92672>(</span>longestNameByAlphabet<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#39;B&#39;</span><span style=color:#f92672>).</span><span style=color:#a6e22e>get</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getName</span><span style=color:#f92672>(),</span> <span style=color:#e6db74>&#34;Bill Gates&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    assertEquals<span style=color:#f92672>(</span>longestNameByAlphabet<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#39;J&#39;</span><span style=color:#f92672>).</span><span style=color:#a6e22e>get</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getName</span><span style=color:#f92672>(),</span> <span style=color:#e6db74>&#34;Jeff Bezos&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    assertEquals<span style=color:#f92672>(</span>longestNameByAlphabet<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#39;M&#39;</span><span style=color:#f92672>).</span><span style=color:#a6e22e>get</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getName</span><span style=color:#f92672>(),</span> <span style=color:#e6db74>&#34;Mark Zuckerberg&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=toarray-转换为数组>toArray() 转换为数组</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java></code></pre></div><h3 id=count-统计总量>count() 统计总量</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java></code></pre></div><h3 id=max-最大值>max() 最大值</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java></code></pre></div><h3 id=min-最小值>min() 最小值</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java></code></pre></div><h3 id=average-平均数>average() 平均数</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java></code></pre></div><h3 id=reduce-自定义聚集结果>reduce() 自定义聚集结果</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>whenApplyReduceOnStream_thenGetValue</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    Double sumSal <span style=color:#f92672>=</span> empList<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>.</span><span style=color:#a6e22e>map</span><span style=color:#f92672>(</span>Employee<span style=color:#f92672>::</span>getSalary<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>.</span><span style=color:#a6e22e>reduce</span><span style=color:#f92672>(</span><span style=color:#ae81ff>0</span><span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>,</span> Double<span style=color:#f92672>::</span>sum<span style=color:#f92672>);</span> <span style=color:#75715e>//起始值为0，每次对所有流元素进行累加
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    assertEquals<span style=color:#f92672>(</span>sumSal<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> Double<span style=color:#f92672>(</span><span style=color:#ae81ff>600000</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=orelse-其他情况>orElse() 其他情况</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>whenFindFirst_thenGetFirstEmployeeInStream</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    Integer<span style=color:#f92672>[]</span> empIds <span style=color:#f92672>=</span> <span style=color:#f92672>{</span><span style=color:#ae81ff>1</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>3</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>4</span><span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>    Employee employee <span style=color:#f92672>=</span> Stream<span style=color:#f92672>.</span><span style=color:#a6e22e>of</span><span style=color:#f92672>(</span>empIds<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>map</span><span style=color:#f92672>(</span>employeeRepository<span style=color:#f92672>::</span>findById<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>filter</span><span style=color:#f92672>(</span>e <span style=color:#f92672>-&gt;</span> e <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>filter</span><span style=color:#f92672>(</span>e <span style=color:#f92672>-&gt;</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>getSalary</span><span style=color:#f92672>()</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>100000</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>findFirst</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>orElse</span><span style=color:#f92672>(</span><span style=color:#66d9ef>null</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>employee<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=orelsethrow>orElseThrow()</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>whenApplySumOnIntStream_thenGetSum</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    Double avgSal <span style=color:#f92672>=</span> empList<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>mapToDouble</span><span style=color:#f92672>(</span>Employee<span style=color:#f92672>::</span>getSalary<span style=color:#f92672>)</span><span style=color:#75715e>//只获取工资数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>average</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>orElseThrow</span><span style=color:#f92672>(</span>NoSuchElementException<span style=color:#f92672>::</span><span style=color:#66d9ef>new</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>avgSal<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=api备忘>API备忘</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 静态方法引用：ClassName::methodName
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 实例上的实例方法引用：instanceReference::methodName
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 超类上的实例方法引用：super::methodName
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 类型上的实例方法引用：ClassName::methodName
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 构造方法引用：Class::new
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 数组构造方法引用：TypeName[]::new
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span></code></pre></div></div></div><nav id=article-nav><div id=article-nav-newer class=article-nav-title><a href=/post/softwarebak/>Win备忘</a></div><div id=article-nav-older class=article-nav-title><a href=/post/maven/>Maven</a></div></nav></article><div id=toc class=toc-article><strong class=toc-title>文章目录</strong><ol class=toc><nav id=TableOfContents><ul><li><a href=#概括>概括</a></li><li><a href=#获取流>获取流</a></li><li><a href=#数据操作>数据操作</a><ul><li><a href=#peek-元素调整>peek() 元素调整</a></li><li><a href=#map-映射转换>map() 映射转换</a></li><li><a href=#flatmap-展平结果>flatMap() 展平结果</a></li><li><a href=#filter-过滤>filter 过滤</a></li><li><a href=#skip-跳过>skip() 跳过</a></li><li><a href=#limit-获取>limit() 获取</a></li><li><a href=#sorted-排序>sorted() 排序</a></li><li><a href=#distinct-去重>distinct() 去重</a></li><li><a href=#match-匹配判定>match() 匹配判定</a></li><li><a href=#parallel-并行处理>parallel() 并行处理</a></li></ul></li><li><a href=#结束操作>结束操作</a><ul><li><a href=#foreach>forEach()</a></li><li><a href=#findfirst-获取首个>findFirst() 获取首个</a></li><li><a href=#collect-集合类型转换>collect() 集合类型转换</a></li><li><a href=#toarray-转换为数组>toArray() 转换为数组</a></li><li><a href=#count-统计总量>count() 统计总量</a></li><li><a href=#max-最大值>max() 最大值</a></li><li><a href=#min-最小值>min() 最小值</a></li><li><a href=#average-平均数>average() 平均数</a></li><li><a href=#reduce-自定义聚集结果>reduce() 自定义聚集结果</a></li><li><a href=#orelse-其他情况>orElse() 其他情况</a></li><li><a href=#orelsethrow>orElseThrow()</a></li></ul></li><li><a href=#api备忘>API备忘</a></li></ul></nav></ol></div><style>.left-col .switch-btn{display:none}.left-col .switch-area{display:none}@media only screen and (min-device-width:320px) and (max-device-width:480px){#mobileAd{width:100%;height:250px}}@media only screen and (min-device-width:320px) and (max-device-width:480px){#musicAd{width:100%}}</style><script src=/js/2.3.6_require.min.js></script>
<script src=/js/3.6.3_jquery.min.js></script>
<script>var valueHide="隐藏目录",valueShow="显示目录";$(".left-col").is(":hidden")&&$("#tocButton").attr("value",valueShow),$("#tocButton").click(function(){$("#toc").is(":hidden")?($("#tocButton").attr("value",valueHide),$("#toc").slideDown(320),$(".switch-btn, .switch-area").fadeOut(300)):($("#tocButton").attr("value",valueShow),$("#toc").slideUp(350),$(".switch-btn, .switch-area").fadeIn(500))})</script><div class=share style=display:none></div><div class=scroll id=post-nav-button><a href=/post/softwarebak/ title="上一篇: Win备忘"><i class="fa fa-angle-left"></i></a>
<a title=文章列表><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
<a href=/post/maven/ title="下一篇: Maven"><i class="fa fa-angle-right"></i></a></div><ul class="post-list toc-article"><li class=post-list-item><a class=post-list-link href=/post/softwarebak/ target=_self>Win备忘</a></li><li class=post-list-item><a class=post-list-link href=/post/maven/ target=_self>Maven</a></li><li class=post-list-item><a class=post-list-link href=/post/jdk8stream/ target=_self>JDK8 Stream</a></li><li class=post-list-item><a class=post-list-link href=/post/welcome/ target=_self>Welcome</a></li></ul><script src=/js/2.3.6_require.min.js></script>>
<script src=/js/3.6.3_jquery.min.js></script>>
<script>$(".post-list").addClass("toc-article"),$(".post-list-item a").attr("target","_Self"),$("#post-nav-button > a:nth-child(2)").click(function(){$(".fa-bars, .fa-times").toggle(),$(".post-list").toggle(300),$(".toc").length>0?$("#toc, #tocButton").toggle(200,function(){$(".switch-area").is(":visible")&&($("#toc, .switch-btn, .switch-area").toggle(),$("#tocButton").attr("value",valueHide))}):$(".switch-btn, .switch-area").fadeToggle(300)})</script><script>(function(e){setInterval(()=>{e.each(e("iframe"),(t,n)=>{let s=e(n).attr("src");s==null&&e(n).remove()})},300)})(jQuery)</script><script></script></div><footer id=footer><div class=outer><div id=footer-info><div class=footer-left>&copy; 2023 aliveyang</div><div class=footer-right><a href=http://gohugo.io/ target=_self>Hugo</a> Theme <a href=https://github.com/NightFarmer/hugo-theme-yelee target=_blank>Yelee</a> by NightFarmer</div></div><div class=visit><span id=busuanzi_container_site_pv style=display:none><span id=site-visit>本站到访数:
<span id=busuanzi_value_site_uv></span></span></span>
<span>,</span>
<span id=busuanzi_container_page_pv style=display:none><span id=page-visit>本页阅读量:
<span id=busuanzi_value_page_pv></span></span></span></div></div></footer></div><script src=/js/2.3.6_require.min.js></script>>
<script src=/js/3.6.3_jquery.min.js></script>>
<script src=/js/main.js></script>
<script>$(document).ready(function(){var e=["#9db3f4","#414141","#e5a859","#f5dfc6","#c084a0","#847e72","#cd8390","#996731"],t=Math.ceil(Math.random()*(e.length-1));$("body").css({"background-color":e[t],"background-size":"cover"})})</script><div class=scroll id=scroll><a href=# title=返回顶部><i class="fa fa-arrow-up"></i></a>
<a href=#footer title=转到底部><i class="fa fa-arrow-down"></i></a></div><script>$(document).ready(function(){$("#comments").length<1&&$("#scroll > a:nth-child(2)").hide()})</script></script><script>(function(){var t=document.createElement("script"),e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)})()</script></div></body></html>